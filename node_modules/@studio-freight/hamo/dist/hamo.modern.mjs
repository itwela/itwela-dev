import{useCallback as e,useEffect as t,useState as n,useMemo as r,useRef as o}from"react";import c from"@studio-freight/tempus";import i from"just-debounce-it";import{create as s}from"zustand";import{createNanoEvents as u}from"nanoevents";function a(n,r){const o=e(e=>{n.current&&!n.current.contains(e.target)&&r()},[n,r]);t(()=>{if(n.current)return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[o,n])}function d(){const[e,r]=n(!1);return t(()=>{r(!0)},[]),e}function f(){const e=d();return r(()=>{if(!e)return;const t=window.location,n=t.href,r=new URLSearchParams(t.search),o=n.includes("#debug")||n.includes("/_debug")||r.has("debug")||"development"===process.env.NODE_ENV,c=n.includes("#production")||r.has("production");return o&&!c},[e])}function l(){const[e,r]=n();return t(()=>{function e(){r(document.readyState)}return document.addEventListener("readystatechange",e,!1),e(),()=>document.removeEventListener("readystatechange",e,!1)},[]),e}function m(e,n=0){t(()=>{if(e)return c.add(e,n),()=>c.remove(e)},[e,n])}function h({root:r=null,rootMargin:c="0px",threshold:i=0,once:s=!1,lazy:u=!1,callback:a=(()=>{})}={},d=[]){const f=o({}),[l,m]=n({}),[h,v]=n();t(()=>{if(!h)return;const e=new IntersectionObserver(([t])=>{u?f.current=t:m(t),a(t),s&&t.isIntersecting&&e.disconnect()},{root:r,rootMargin:c,threshold:i});return e.observe(h),()=>{e.disconnect()}},[h,r,c,i,u,s,...d]);const p=e(()=>f.current,[]);return[v,u?p:l]}function v(e,n=1e3,r=[]){t(()=>{const t=setInterval(e,n);return()=>clearInterval(t)},[n,...r])}function p(){const[e,r]=n();return t(()=>{function e(){r("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)}return window.addEventListener("resize",e,!1),e(),()=>{window.removeEventListener("resize",e,!1)}},[]),e}function w(e){const[r,o]=n();return t(()=>{const t=window.matchMedia(e);function n(){o(t.matches)}return t.addEventListener("change",n,!1),n(),()=>t.removeEventListener("change",n,!1)},[e]),r}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}function g({lazy:r=!1,debounce:c=500,box:s="border-box",callback:u=(()=>{})}={},a=[]){const d=o({}),[f,l]=n({}),[m,h]=n();t(()=>{if(!m)return;const e=i(([e])=>{d.current=e,u(e),r||l(e)},c,!0),t=new ResizeObserver(e);return t.observe(m,{box:s}),()=>{t.disconnect(),e.cancel()}},[m,r,c,s,...a]);const v=e(()=>d.current,[]);return[h,r?v:f]}function y(e){"sticky"===getComputedStyle(e).position&&(e.style.setProperty("position","static"),e.dataset.sticky="true"),e.offsetParent&&y(e.offsetParent)}function E(e){var t;"true"===(null==e||null==(t=e.dataset)?void 0:t.sticky)&&(e.style.removeProperty("position"),e.dataset.sticky="true",delete e.dataset.sticky),e.parentNode&&E(e.parentNode)}function z(e,t=0){const n=t+e.offsetTop;return e.offsetParent?z(e.offsetParent,n):n}function P(e,t=0){const n=t+e.offsetLeft;return e.offsetParent?P(e.offsetParent,n):n}function L(e,t=0){const n=t+e.scrollTop;return e.offsetParent?L(e.offsetParent,n):n+window.scrollY}function k(e,t=0){const n=t+e.scrollLeft;return e.offsetParent?k(e.offsetParent,n):n+window.scrollX}const S=s(e=>({elements:[],addElement:t=>{e(e=>({elements:[...e.elements,t]}))},removeElement:t=>{e(e=>({elements:e.elements.filter(e=>e!==t)}))}})),x=u();function O({ignoreTransform:r=!1,ignoreSticky:c=!0,lazy:s=!1,debounce:u=500,callback:a=(()=>{})}={}){const[d,f]=n(),[l,m]=n({}),h=o({}),v=e(e=>{const t=e.borderBoxSize[0].blockSize;h.current.width=e.borderBoxSize[0].inlineSize,h.current.height=t,a(h.current),s||m(b({},h.current))},[s]),[p]=g({lazy:!0,debounce:u,callback:v},[u,v]),w=S(({elements:e})=>e),O=e(()=>{if(!d)return;let e,t;if(c&&y(d),r)e=z(d),t=P(d);else{const n=d.getBoundingClientRect();e=n.top+L(d),t=n.left+k(d)}c&&E(d),h.current.top=e,h.current.left=t,a(h.current),s||m(b({},h.current))},[r,c,s,d]);t(()=>{const e=i(O,u,!0),t=new ResizeObserver(e);return t.observe(document.body),w.forEach(e=>{t.observe(e)}),()=>{t.disconnect(),e.cancel()}},[w,u,O]);const M=e(()=>h.current,[]);return t(()=>x.on("resize",function(){if(!d)return;const e=d.getBoundingClientRect();h.current.width=e.width,h.current.height=e.height,O()}),[d,O]),[e=>{f(e),p(e)},s?M:l]}function M(e=[],t=[]){const n=r(()=>t&&[t].flat(),[t]),o=r(()=>e&&[e].flat(),[e]);return r(()=>{if(!n||!o)return;const t=o.map(e=>{var t;return null==(t=n.find(t=>t.type===e))?void 0:t.props.children});return e[0]?t:t[0]},[n,o])}function R(e=500){const[r,o]=n(),[c,s]=n();return t(()=>{const t=i(()=>{o(Math.min(window.innerWidth,document.documentElement.clientWidth)),s(Math.min(window.innerHeight,document.documentElement.clientHeight))},e,!0);return window.addEventListener("resize",t,!1),t(),()=>window.removeEventListener("resize",t,!1)},[e]),{width:r,height:c}}O.observe=function(e){S.getState().addElement(e)},O.unobserve=function(e){S.getState().removeElement(e)},O.resize=function(){x.emit("resize")};export{f as useDebug,l as useDocumentReadyState,m as useFrame,h as useIntersectionObserver,v as useInterval,d as useIsClient,p as useIsTouchDevice,w as useMediaQuery,a as useOutsideClickEvent,O as useRect,g as useResizeObserver,M as useSlots,R as useWindowSize};
//# sourceMappingURL=hamo.modern.mjs.map
